---
title: '[Next.js] fetch関数で取得したデータをキャッシュにしない' # 記事のタイトル
emoji: '⚡' # アイキャッチとして使われる絵文字（1文字だけ）
type: 'tech' # tech: 技術記事 / idea: アイデア記事
topics: ['nextjs', 'フロントエンド', 'typescript', '初心者向け'] # タグ。["markdown", "rust", "aws"]のように指定する
published: true # 公開設定（falseにすると下書き）
---

## はじめに

`Next.js`の学習の為に、下記書籍を読みました。
下記書籍の`キャッシュ`について学びがあったので、執筆します。
@[card](https://gihyo.jp/book/2024/978-4-297-14061-8)

## 結論

:::message
**{ cache: "no-store" }** を fetch 関数のオプションを追加する

```diff:ts
- fetch(`http://...`);
+ fetch(`http://...`, { cache: 'no-store' });
```

:::

> **キャッシュとは、**
> Webページや画像、スクリプトなどのコンテンツを一時的に保存する仕組みです。
> これにより、同じページに再度アクセスするときにサーバーにリクエストを送ることなく、
> 素早くコンテンツを表示することができます。


## 使い分け

### 1. 動的データ

:::message
{ cache: "no-store" }のオプションを**追加する**
:::
例えば、下記項目のような**変更が多いデータ**に対して有効

1. 閲覧履歴
2. 商品在庫数

### 2. 静的データ(キャッシュ)

:::message
{ cache: "no-store" }のオプションを**追加しない**
:::
例えば、下記項目のような**変更が少ないデータ**に対して有効

1. 商品概要
2. ブログ記事
3. ニュース記事

## 補足事項

### 1. 初期値は、キャッシュになる

:::message
fetch 関数でオプションを指定しなければ、静的データ(キャッシュ)となる
:::

```ts
fetch(`http://...`);
```

### 2. npm run dev で動作確認しない

:::message alert
npm run dev でのアプリ起動では、正しい挙動をしない可能性がある
:::
下記コマンドならキャッシュを一度削除すれば、挙動を確認できる

```bash
rm -rf .next/cache
npm run build
npm start
```
